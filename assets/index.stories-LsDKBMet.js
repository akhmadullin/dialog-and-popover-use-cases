import{j as s,c as N,C as v,H as F,T as B}from"./index-Cc0r8_xM.js";import{B as w}from"./index-CFho4Kze.js";import{r as b}from"./index-DVXBtNgz.js";const T="_menu_brbhz_1",W="_menuOption_brbhz_21",k="_menuOptionButton_brbhz_29",z="_menuOptionButtonWithSubMenu_brbhz_46",H="_menuSubMenu_brbhz_72",f={menu:T,menuOption:W,menuOptionButton:k,menuOptionButtonWithSubMenu:z,menuSubMenu:H},P=()=>{const e=b.useRef({}),t=b.useCallback((i,r)=>{if(r==null){delete e.current[i];return}e.current={...e.current,[i]:r}},[]);return[e,t]},K=9,U=27,$=40,G=38,q=39,J=37,Q=(e,t)=>e?{liData:{style:{anchorName:t}},buttonData:{"aria-haspopup":!0,"aria-expanded":!1,popovertarget:e}}:{},A=b.forwardRef(({subMenu:e,subMenuId:t,anchorName:i,children:r,...x},c)=>{const{liData:p,buttonData:E}=Q(t,i);return s.jsxs("li",{role:"none",...p,className:f.menuOption,children:[s.jsx("button",{ref:c,type:"button",role:"menuitem",tabIndex:-1,...E,className:N(f.menuOptionButton,{[f.menuOptionButtonWithSubMenu]:t}),...x,children:r}),e]})});A.__docgenInfo={description:"",methods:[],displayName:"MenuItem"};const V=(e,t)=>{if(!t)return{};const i=`${e}-submenu`,r=`--submenu-button-${e}`;return{subMenuElement:s.jsx(C,{id:i,anchorName:r,items:t.items,ariaLabel:t.ariaLabel,isSubMenu:!0}),subMenuId:i,subMenuButtonAnchorName:r}},M=1,C=({id:e,anchorName:t,items:i,isSubMenu:r,ariaLabel:x})=>{const c=b.useRef(null),[p,E]=P(),D=i.map((n,u)=>({...n,idx:u,"data-idx":u}));b.useLayoutEffect(()=>{var u;const n=o=>{o.newState==="open"&&p.current[0].focus()};return(u=c.current)==null||u.addEventListener("toggle",n),()=>{var o;(o=c.current)==null||o.removeEventListener("toggle",n)}},[p]),b.useLayoutEffect(()=>{var u;if(!r)return;const n=o=>{var m,l,d,a;o.newState==="open"?(l=(m=c.current)==null?void 0:m.previousSibling)==null||l.setAttribute("aria-expanded",!0):(a=(d=c.current)==null?void 0:d.previousSibling)==null||a.setAttribute("aria-expanded",!1)};return(u=c.current)==null||u.addEventListener("beforetoggle",n),()=>{var o;r&&((o=c.current)==null||o.removeEventListener("beforetoggle",n))}},[r]);const y=n=>{var u;n.keyCode===K&&((u=c.current)==null||u.hidePopover())},R=n=>{var o,m,l;const u=n.target;switch(n.keyCode){case $:{n.preventDefault();const d=Number(u.dataset.idx);let a=d===0?1:d+M;a>=D.length&&(a=0),p.current[a].focus();break}case G:{n.preventDefault();let a=Number(u.dataset.idx)-M;a<0&&(a=D.length-1),p.current[a].focus();break}case J:case q:{n.preventDefault();break}case U:{if(!r)return;(l=(m=(o=u.parentNode)==null?void 0:o.parentNode)==null?void 0:m.previousSibling)==null||l.focus();break}}};return s.jsx("ul",{ref:c,id:e,role:"menu","aria-label":x,popover:"auto",onKeyDown:y,className:N(f.menu,{[f.menuSubMenu]:r}),style:{"--menu-button-anchor-name":t},children:D.map(({id:n,content:u,subMenu:o,idx:m,action:l,...d})=>{const{subMenuElement:a,subMenuId:g,subMenuButtonAnchorName:L}=V(n,o);return s.jsx(A,{ref:j=>{E(m,j)},onKeyDown:R,onClick:l,subMenu:a,subMenuId:g,anchorName:L,...d,children:u},n)})})},S=e=>s.jsx(C,{...e});S.__docgenInfo={description:"",methods:[],displayName:"Menu"};const ne={title:"Popover Based/Menu"},X=[{id:"open",content:"Открыть"},{id:"edit",content:"Редактировать"},{id:"close",content:"Закрыть"},{id:"more",content:"Еще",subMenu:{ariaLabel:"Еще",items:[{id:"a1",content:"Действие раз"},{id:"a2",content:"Действие два",subMenu:{ariaLabel:"Действие два",items:[{id:"b1",content:"Поддействие раз"},{id:"b2",content:"Поддействие два"},{id:"b3",content:"Поддействие три"}]}},{id:"a3",content:"Действие три"}]}}],h={render:()=>{const e="menuId",t="--menu-button-anchor";return s.jsxs(v,{children:[s.jsx(F,{children:"Меню"}),s.jsx(B,{children:'Поповер также отлично ложится в UI-паттерн "меню".'}),s.jsx(B,{children:"Элементы меню в примере ниже не имеют под собой никакого функционала, приведены просто для наглядности."}),s.jsx(w,{popovertarget:e,style:{anchorName:t,marginLeft:"300px"},children:"Открыть меню"}),s.jsx(S,{id:e,anchorName:t,items:X,ariaLabel:"Actions"})]})}};var _,I,O;h.parameters={...h.parameters,docs:{...(_=h.parameters)==null?void 0:_.docs,source:{originalSource:`{
  render: () => {
    const menuId = 'menuId';
    const anchorName = '--menu-button-anchor';
    return <Container>
                <Heading>Меню</Heading>
                <Text>Поповер также отлично ложится в UI-паттерн "меню".</Text>
                <Text>
                    Элементы меню в примере ниже не имеют под собой никакого функционала, приведены просто для
                    наглядности.
                </Text>
                <Button popovertarget={menuId} style={{
        anchorName,
        marginLeft: '300px'
      }}>
                    Открыть меню
                </Button>
                <Menu id={menuId} anchorName={anchorName} items={itemsSample} ariaLabel="Actions" />
            </Container>;
  }
}`,...(O=(I=h.parameters)==null?void 0:I.docs)==null?void 0:O.source}}};const ue=["MenuStory"];export{h as MenuStory,ue as __namedExportsOrder,ne as default};
